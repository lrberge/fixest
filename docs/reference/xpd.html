<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Expands formula macros — xpd • fixest</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Expands formula macros — xpd" />
<meta property="og:description" content="Create macros within formulas and expand them with character vectors or other formulas." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fixest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/exporting_tables.html">Exporting estimation tables</a>
    </li>
    <li>
      <a href="../articles/fixest_walkthrough.html">Fast Fixed-Effects Estimation: Short introduction</a>
    </li>
    <li>
      <a href="../articles/multiple_estimations.html">Multiple estimations</a>
    </li>
    <li>
      <a href="../articles/standard_errors.html">On standard-errors</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lrberge/fixest/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Expands formula macros</h1>
    <small class="dont-index">Source: <a href='https://github.com/lrberge/fixest/blob/master/R/MiscFuns.R'><code>R/MiscFuns.R</code></a></small>
    <div class="hidden name"><code>xpd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create macros within formulas and expand them with character vectors or other formulas.</p>
    </div>

    <pre class="usage"><span class='fu'>xpd</span><span class='op'>(</span><span class='va'>fml</span>, <span class='va'>...</span>, <span class='va'>lhs</span>, <span class='va'>rhs</span>, data <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fml</th>
      <td><p>A formula containing macros variables. Each macro variable must start with two dots. The macro variables can be set globally using <code>setFixest_fml</code>, or can be defined in <code>...</code>. Special macros of the form <code>..("regex")</code> can be used to fetch, through a regular expression, variables directly in a character vector (or in column names) given in the argument <code>data</code>. square brackets have a special meaning: Values in them are evaluated and parsed accordingly. Example: <code>y~x.[1:2] + z.[i]</code> will lead to <code>y~x1+x2+z3</code> if <code>i==3</code>. See examples.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Definition of the macro variables. Each argument name corresponds to the name of the macro variable. It is required that each macro variable name starts with two dots (e.g. <code>..ctrl</code>). The value of each argument must be a one-sided formula or a character vector, it is the definition of the macro variable. Example of a valid call: <code><a href='setFixest_fml.html'>setFixest_fml(..ctrl = ~ var1 + var2)</a></code>. In the function <code>xpd</code>, the default macro variables are taken from <code>getFixest_fml</code>, any variable in <code>...</code> will replace these values. You can enclose values in <code>.[]</code>, if so they will be evaluated from the current environment. For example <code>..ctrl = ~ x.[1:2] + .[z]</code> will lead to <code>~x1 + x2 + var</code> if <code>z</code> is equal to <code>"var"</code>.</p></td>
    </tr>
    <tr>
      <th>lhs</th>
      <td><p>If present then a formula will be constructed with <code>lhs</code> as the full left-hand-side. The value of <code>lhs</code> can be a one-sided formula, a call, or a character vector. Note that the macro variables wont be applied. You can use it in combination with the argument <code>rhs</code>. Note that if <code>fml</code> is not missing, its LHS will be replaced by <code>lhs</code>.</p></td>
    </tr>
    <tr>
      <th>rhs</th>
      <td><p>If present, then a formula will be constructed with <code>rhs</code> as the full right-hand-side. The value of <code>rhs</code> can be a one-sided formula, a call, or a character vector. Note that the macro variables wont be applied. You can use it in combination with the argument <code>lhs</code>. Note that if <code>fml</code> is not missing, its RHS will be replaced by <code>rhs</code>.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>Either a character vector or a data.frame. This argument will only be used if a macro of the type <code>..("regex")</code> is used in the formula of the argument <code>fml</code>. If so, any variable name from <code>data</code> that matches the regular expression will be added to the formula.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>It returns a formula where all macros have been expanded.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In <code>xpd</code>, the default macro variables are taken from <code>getFixest_fml</code>. Any value in the <code>...</code> argument of <code>xpd</code> will replace these default values.</p>
<p>The definitions of the macro variables will replace in verbatim the macro variables. Therefore, you can include multi-part formulas if you wish but then beware of the order of the macros variable in the formula. For example, using the <code>airquality</code> data, say you want to set as controls the variable <code>Temp</code> and <code>Day</code> fixed-effects, you can do <code><a href='setFixest_fml.html'>setFixest_fml(..ctrl = ~Temp | Day)</a></code>, but then <code><a href='feols.html'>feols(Ozone ~ Wind + ..ctrl, airquality)</a></code> will be quite different from <code><a href='feols.html'>feols(Ozone ~ ..ctrl + Wind, airquality)</a></code>, so beware!</p>
    <h2 class="hasAnchor" id="dot-square-bracket-operator-in-formulas"><a class="anchor" href="#dot-square-bracket-operator-in-formulas"></a>Dot square bracket operator in formulas</h2>

    


<p>In a formula, the dot square bracket (DSB) operator can: i) create manifold variables at once, or ii) capture values from the current environment and put them verbatim in the formula.</p>
<p>Say you want to include the variables <code>x1</code> to <code>x3</code> in your formula. You can use <code>xpd(y ~ x.[1:3])</code> and you'll get <code>y ~ x1 + x2 + x3</code>.</p>
<p>To summon values from the environment, simply put the variable in square brackets. For example: <code>for(i in 1:3) xpd(y.[i] ~ x)</code> will create the formulas <code>y1 ~ x</code> to <code>y3 ~ x</code> depending on the value of <code>i</code>.</p>
<p>You can include a full variable from the environment in the same way: <code>for(y in c("a", "b")) xpd(.[y] ~ x)</code> will create the two formulas <code>a ~ x</code> and <code>b ~ x</code>.</p>
<p>The DSB can even be used within variable names, but then the variable must be nested in character form. For example <code>y ~ .["x.[1:2]_sq"]</code> will create <code>y ~ x1_sq +  x2_sq</code>. Using the character form is important to avoid a formula parsing error.</p>
<p>In all <code>fixest</code> estimations, this special parsing is enabled, so you don't need to use <code>xpd</code>.</p>
<p>Limitations: the use of multiple square brackets within a single variable is not implemented. For example, the following will not work <code>xpd(y ~ ..x, ..x = x.[1:3]_.[1:3])</code>.</p>
    <h2 class="hasAnchor" id="regular-expressions"><a class="anchor" href="#regular-expressions"></a>Regular expressions</h2>

    


<p>You can catch several variable names at once by using regular expressions. To use regular expressions, you need to enclose it in the dot-dot function: <code>..("regex")</code>. For example, <code>..("Sepal")</code> will catch both the variables <code>Sepal.Length</code> and <code>Sepal.Width</code> from the <code>iris</code> data set. In a <code>fixest</code> estimation, the variables names from which the regex will be applied come from the data set. If you use <code>xpd</code>, you need to provide either a data set or a vector of names in the argument <code>data</code>.</p>
<p>Note that the dot square bracket operator (DSB, see before) is applied before the regular expression is evaluated. This means that <code>..("x.[3:4]_sq")</code> will lead, after evaluation of the DSB, to <code>..("x3_sq|x4_sq")</code>. It is a handy way to insert range of numbers in a regular expression.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='setFixest_fml.html'>setFixest_fml</a></code> to set formula macros.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Small examples with airquality data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>airquality</span><span class='op'>)</span>
<span class='co'># we set two macro variables</span>
<span class='fu'><a href='setFixest_fml.html'>setFixest_fml</a></span><span class='op'>(</span>..ctrl <span class='op'>=</span> <span class='op'>~</span> <span class='va'>Temp</span> <span class='op'>+</span> <span class='va'>Day</span>,
              ..ctrl_long <span class='op'>=</span> <span class='op'>~</span> <span class='fu'><a href='https://rdrr.io/r/stats/poly.html'>poly</a></span><span class='op'>(</span><span class='va'>Temp</span>, <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/poly.html'>poly</a></span><span class='op'>(</span><span class='va'>Day</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Using the macro in lm with xpd:</span>
<span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='fu'>xpd</span><span class='op'>(</span><span class='va'>Ozone</span> <span class='op'>~</span> <span class='va'>Wind</span> <span class='op'>+</span> <span class='va'>..ctrl</span><span class='op'>)</span>, <span class='va'>airquality</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lm(formula = xpd(Ozone ~ Wind + ..ctrl), data = airquality)
#&gt; 
#&gt; Coefficients:
#&gt; (Intercept)         Wind         Temp          Day  
#&gt;    -76.5168      -3.0681       1.8622       0.2506  
#&gt; </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='fu'>xpd</span><span class='op'>(</span><span class='va'>Ozone</span> <span class='op'>~</span> <span class='va'>Wind</span> <span class='op'>+</span> <span class='va'>..ctrl_long</span><span class='op'>)</span>, <span class='va'>airquality</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lm(formula = xpd(Ozone ~ Wind + ..ctrl_long), data = airquality)
#&gt; 
#&gt; Coefficients:
#&gt;    (Intercept)            Wind  poly(Temp, 2)1  poly(Temp, 2)2   poly(Day, 2)1  
#&gt;         69.603          -2.773         206.921          90.449          26.681  
#&gt;  poly(Day, 2)2  
#&gt;         20.483  
#&gt; </div><div class='input'>
<span class='co'># You can use the macros without xpd() in fixest estimations</span>
<span class='va'>a</span> <span class='op'>=</span> <span class='fu'><a href='feols.html'>feols</a></span><span class='op'>(</span><span class='va'>Ozone</span> <span class='op'>~</span> <span class='va'>Wind</span> <span class='op'>+</span> <span class='va'>..ctrl</span>, <span class='va'>airquality</span><span class='op'>)</span>
<span class='va'>b</span> <span class='op'>=</span> <span class='fu'><a href='feols.html'>feols</a></span><span class='op'>(</span><span class='va'>Ozone</span> <span class='op'>~</span> <span class='va'>Wind</span> <span class='op'>+</span> <span class='va'>..ctrl_long</span>, <span class='va'>airquality</span><span class='op'>)</span>
<span class='fu'><a href='etable.html'>etable</a></span><span class='op'>(</span><span class='va'>a</span>, <span class='va'>b</span>, keep <span class='op'>=</span> <span class='st'>"Int|Win"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                                  a                  b
#&gt; Dependent Var.:              Ozone              Ozone
#&gt;                                                      
#&gt; (Intercept)       -76.52** (24.11)   69.60*** (6.637)
#&gt; Wind            -3.068*** (0.6629) -2.773*** (0.6451)
#&gt; _______________ __________________ __________________
#&gt; S.E. type                      IID                IID
#&gt; Observations                   116                116
#&gt; R2                         0.57308            0.62167
#&gt; Adj. R2                    0.56164            0.60447</div><div class='input'>

<span class='co'># Using .[]</span>

<span class='va'>base</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span><span class='va'>iris</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y"</span>, <span class='st'>"x1"</span>, <span class='st'>"x2"</span>, <span class='st'>"x3"</span>, <span class='st'>"species"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>i</span> <span class='op'>=</span> <span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span>
<span class='va'>z</span> <span class='op'>=</span> <span class='st'>"species"</span>
<span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='fu'>xpd</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x.</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>.</span><span class='op'>[</span><span class='va'>z</span><span class='op'>]</span><span class='op'>)</span>, <span class='va'>base</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lm(formula = xpd(y ~ x.[2:3] + .[z]), data = base)
#&gt; 
#&gt; Coefficients:
#&gt;       (Intercept)                 x2                 x3  speciesversicolor  
#&gt;          3.682982           0.905946          -0.005995          -1.598362  
#&gt;  speciesvirginica  
#&gt;         -2.112647  
#&gt; </div><div class='input'>
<span class='co'># No xpd() needed in feols</span>
<span class='fu'><a href='feols.html'>feols</a></span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x.</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>.</span><span class='op'>[</span><span class='va'>z</span><span class='op'>]</span>, <span class='va'>base</span><span class='op'>)</span>
</div><div class='output co'>#&gt; OLS estimation, Dep. Var.: y
#&gt; Observations: 150 
#&gt; Standard-errors: IID 
#&gt;                    Estimate Std. Error   t value   Pr(&gt;|t|)    
#&gt; (Intercept)        3.682982   0.107403 34.291343  &lt; 2.2e-16 ***
#&gt; x2                 0.905946   0.074311 12.191282  &lt; 2.2e-16 ***
#&gt; x3                -0.005995   0.156260 -0.038368 9.6945e-01    
#&gt; speciesversicolor -1.598362   0.205706 -7.770113 1.3154e-12 ***
#&gt; speciesvirginica  -2.112647   0.304024 -6.948940 1.1550e-10 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; RMSE: 0.333482   Adj. R2: 0.832221</div><div class='input'>
<span class='co'>#</span>
<span class='co'># You can use xpd for stepwise estimations</span>
<span class='co'>#</span>

<span class='co'># Note that for stepwise estimations in fixest, you can use</span>
<span class='co'># the stepwise functions: sw, sw0, csw, csw0</span>
<span class='co'># -&gt; see help in feols or in the dedicated vignette</span>

<span class='co'># we want to look at the effect of x1 on y</span>
<span class='co'># controlling for different variables</span>

<span class='va'>base</span> <span class='op'>=</span> <span class='va'>iris</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>base</span><span class='op'>)</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"y"</span>, <span class='st'>"x1"</span>, <span class='st'>"x2"</span>, <span class='st'>"x3"</span>, <span class='st'>"species"</span><span class='op'>)</span>

<span class='co'># We first create a matrix with all possible combinations of variables</span>
<span class='va'>my_args</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>base</span><span class='op'>)</span><span class='op'>[</span><span class='op'>-</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>]</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>""</span>, <span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>(</span><span class='va'>all_combs</span> <span class='op'>=</span> <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/as.matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='st'>"expand.grid"</span>, <span class='va'>my_args</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      Var1 Var2 Var3     
#&gt; [1,] ""   ""   ""       
#&gt; [2,] "x2" ""   ""       
#&gt; [3,] ""   "x3" ""       
#&gt; [4,] "x2" "x3" ""       
#&gt; [5,] ""   ""   "species"
#&gt; [6,] "x2" ""   "species"
#&gt; [7,] ""   "x3" "species"
#&gt; [8,] "x2" "x3" "species"</div><div class='input'>
<span class='va'>res_all</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>all_combs</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>res_all</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='feols.html'>feols</a></span><span class='op'>(</span><span class='fu'>xpd</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x1</span> <span class='op'>+</span> <span class='va'>..v</span>, ..v <span class='op'>=</span> <span class='va'>all_combs</span><span class='op'>[</span><span class='va'>i</span>, <span class='op'>]</span><span class='op'>)</span>, <span class='va'>base</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'><a href='etable.html'>etable</a></span><span class='op'>(</span><span class='va'>res_all</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                             model 1            model 2            model 3
#&gt; Dependent Var.:                   y                  y                  y
#&gt;                                                                          
#&gt; (Intercept)       6.526*** (0.4789)  2.249*** (0.2480)  3.457*** (0.3092)
#&gt; x1                 -0.2234 (0.1551) 0.5955*** (0.0693) 0.3991*** (0.0911)
#&gt; x2                                  0.4719*** (0.0171)                   
#&gt; x3                                                     0.9721*** (0.0521)
#&gt; speciesversicolor                                                        
#&gt; speciesvirginica                                                         
#&gt; _________________ _________________ __________________ __________________
#&gt; S.E. type                       IID                IID                IID
#&gt; Observations                    150                150                150
#&gt; R2                          0.01382            0.84018            0.70724
#&gt; Adj. R2                     0.00716            0.83800            0.70325
#&gt;                               model 4            model 5             model 6
#&gt; Dependent Var.:                     y                  y                   y
#&gt;                                                                             
#&gt; (Intercept)         1.856*** (0.2508)  2.251*** (0.3698)   2.390*** (0.2623)
#&gt; x1                 0.6508*** (0.0667) 0.8036*** (0.1063)  0.4322*** (0.0814)
#&gt; x2                 0.7091*** (0.0567)                     0.7756*** (0.0643)
#&gt; x3                -0.5565*** (0.1275)                                       
#&gt; speciesversicolor                      1.459*** (0.1121) -0.9558*** (0.2152)
#&gt; speciesvirginica                       1.947*** (0.1000)  -1.394*** (0.2857)
#&gt; _________________ ___________________ __________________ ___________________
#&gt; S.E. type                         IID                IID                 IID
#&gt; Observations                      150                150                 150
#&gt; R2                            0.85861            0.72591             0.86331
#&gt; Adj. R2                       0.85571            0.72027             0.85954
#&gt;                              model 7            model 8
#&gt; Dependent Var.:                    y                  y
#&gt;                                                        
#&gt; (Intercept)        2.521*** (0.3939)  2.171*** (0.2798)
#&gt; x1                0.6982*** (0.1195) 0.4959*** (0.0861)
#&gt; x2                                   0.8292*** (0.0685)
#&gt; x3                  0.3716. (0.1983)  -0.3152* (0.1512)
#&gt; speciesversicolor 0.9881*** (0.2747) -0.7236** (0.2402)
#&gt; speciesvirginica    1.238** (0.3913)  -1.023** (0.3337)
#&gt; _________________ __________________ __________________
#&gt; S.E. type                        IID                IID
#&gt; Observations                     150                150
#&gt; R2                           0.73238            0.86731
#&gt; Adj. R2                      0.72500            0.86271</div><div class='input'><span class='fu'><a href='coefplot.html'>coefplot</a></span><span class='op'>(</span><span class='va'>res_all</span>, group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>Species <span class='op'>=</span> <span class='st'>"^^species"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='xpd-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#</span>
<span class='co'># You can use macros to grep variables in your data set</span>
<span class='co'>#</span>

<span class='co'># Example 1: setting a macro variable globally</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>longley</span><span class='op'>)</span>
<span class='fu'><a href='setFixest_fml.html'>setFixest_fml</a></span><span class='op'>(</span>..many_vars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grep</a></span><span class='op'>(</span><span class='st'>"GNP|ployed"</span>, <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>longley</span><span class='op'>)</span>, value <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='feols.html'>feols</a></span><span class='op'>(</span><span class='va'>Armed.Forces</span> <span class='op'>~</span> <span class='va'>Population</span> <span class='op'>+</span> <span class='va'>..many_vars</span>, <span class='va'>longley</span><span class='op'>)</span>
</div><div class='output co'>#&gt; OLS estimation, Dep. Var.: Armed.Forces
#&gt; Observations: 16 
#&gt; Standard-errors: IID 
#&gt;                 Estimate  Std. Error   t value Pr(&gt;|t|)    
#&gt; (Intercept)  4403.682352 4091.847594  1.076209 0.307112    
#&gt; Population    -22.844324   32.671302 -0.699217 0.500356    
#&gt; GNP.deflator    7.638472   12.347773  0.618611 0.550003    
#&gt; GNP             3.150533    3.554170  0.886433 0.396201    
#&gt; Unemployed     -0.591649    0.389005 -1.520928 0.159248    
#&gt; Employed      -50.059800   25.348299 -1.974878 0.076522 .  
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; RMSE: 36.1   Adj. R2: 0.569345</div><div class='input'>
<span class='co'># Example 2: using ..("regex") to grep the variables "live"</span>

<span class='fu'><a href='feols.html'>feols</a></span><span class='op'>(</span><span class='va'>Armed.Forces</span> <span class='op'>~</span> <span class='va'>Population</span> <span class='op'>+</span> <span class='fu'>..</span><span class='op'>(</span><span class='st'>"GNP|ployed"</span><span class='op'>)</span>, <span class='va'>longley</span><span class='op'>)</span>
</div><div class='output co'>#&gt; OLS estimation, Dep. Var.: Armed.Forces
#&gt; Observations: 16 
#&gt; Standard-errors: IID 
#&gt;                 Estimate  Std. Error   t value Pr(&gt;|t|)    
#&gt; (Intercept)  4403.682352 4091.847594  1.076209 0.307112    
#&gt; Population    -22.844324   32.671302 -0.699217 0.500356    
#&gt; GNP.deflator    7.638472   12.347773  0.618611 0.550003    
#&gt; GNP             3.150533    3.554170  0.886433 0.396201    
#&gt; Unemployed     -0.591649    0.389005 -1.520928 0.159248    
#&gt; Employed      -50.059800   25.348299 -1.974878 0.076522 .  
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; RMSE: 36.1   Adj. R2: 0.569345</div><div class='input'>
<span class='co'># Example 3: same as Ex.2 but without using a fixest estimation</span>

<span class='co'># Here we need to use xpd():</span>
<span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='fu'>xpd</span><span class='op'>(</span><span class='va'>Armed.Forces</span> <span class='op'>~</span> <span class='va'>Population</span> <span class='op'>+</span> <span class='fu'>..</span><span class='op'>(</span><span class='st'>"GNP|ployed"</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>longley</span><span class='op'>)</span>, <span class='va'>longley</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; lm(formula = xpd(Armed.Forces ~ Population + ..("GNP|ployed"), 
#&gt;     data = longley), data = longley)
#&gt; 
#&gt; Coefficients:
#&gt;  (Intercept)    Population  GNP.deflator           GNP    Unemployed  
#&gt;    4403.6824      -22.8443        7.6385        3.1505       -0.5916  
#&gt;     Employed  
#&gt;     -50.0598  
#&gt; </div><div class='input'>
<span class='co'>#</span>
<span class='co'># You can also put numbers in macros</span>
<span class='co'>#</span>

<span class='va'>res_all</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>res_all</span><span class='op'>[[</span><span class='va'>p</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>=</span> <span class='fu'><a href='feols.html'>feols</a></span><span class='op'>(</span><span class='fu'>xpd</span><span class='op'>(</span><span class='va'>Ozone</span> <span class='op'>~</span> <span class='va'>Wind</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/stats/poly.html'>poly</a></span><span class='op'>(</span><span class='va'>Temp</span>, <span class='va'>..p</span><span class='op'>)</span>, ..p <span class='op'>=</span> <span class='va'>p</span><span class='op'>)</span>, <span class='va'>airquality</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='fu'><a href='etable.html'>etable</a></span><span class='op'>(</span><span class='va'>res_all</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                            model 1            model 2            model 3
#&gt; Dependent Var.:              Ozone              Ozone              Ozone
#&gt;                                                                         
#&gt; (Intercept)       72.28*** (6.847)   70.40*** (6.518)   71.31*** (6.512)
#&gt; Wind            -3.055*** (0.6633) -2.866*** (0.6315) -2.928*** (0.6295)
#&gt; poly(Temp)1       214.7*** (29.17)   209.0*** (27.73)   201.5*** (28.02)
#&gt; poly(Temp)2                          93.36*** (25.44)   101.7*** (25.91)
#&gt; poly(Temp)3                                               -37.32 (25.03)
#&gt; _______________ __________________ __________________ __________________
#&gt; S.E. type                      IID                IID                IID
#&gt; Observations                   116                116                116
#&gt; R2                         0.56871            0.61501            0.62256
#&gt; Adj. R2                    0.56108            0.60469            0.60896</div><div class='input'>
<span class='co'>#</span>
<span class='co'># lhs and rhs arguments</span>
<span class='co'>#</span>

<span class='co'># to create a one sided formula from a character vector</span>
<span class='va'>vars</span> <span class='op'>=</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span>
<span class='fu'>xpd</span><span class='op'>(</span>rhs <span class='op'>=</span> <span class='va'>vars</span><span class='op'>)</span>
</div><div class='output co'>#&gt; ~a + b + c + d + e
#&gt; &lt;environment: 0x0000000042943b48&gt;</div><div class='input'>
<span class='co'># Alternatively, to replace the RHS</span>
<span class='fu'>xpd</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='fl'>1</span>, rhs <span class='op'>=</span> <span class='va'>vars</span><span class='op'>)</span>
</div><div class='output co'>#&gt; y ~ a + b + c + d + e
#&gt; &lt;environment: 0x00000000426d0dd8&gt;</div><div class='input'>
<span class='co'># To create a two sided formula</span>
<span class='fu'>xpd</span><span class='op'>(</span>lhs <span class='op'>=</span> <span class='st'>"y"</span>, rhs <span class='op'>=</span> <span class='va'>vars</span><span class='op'>)</span>
</div><div class='output co'>#&gt; y ~ a + b + c + d + e
#&gt; &lt;environment: 0x00000000442116b8&gt;</div><div class='input'>

<span class='co'>#</span>
<span class='co'># Dot square bracket operator</span>
<span class='co'>#</span>

<span class='co'># You can create multiple variables at once</span>
<span class='fu'>xpd</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x.</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>z.</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; y ~ x1 + x2 + x3 + x4 + x5 + z2 + z3
#&gt; &lt;environment: 0x00000000426d0dd8&gt;</div><div class='input'>
<span class='co'># You can summon variables from the environment</span>
<span class='va'>var</span> <span class='op'>=</span> <span class='st'>"a"</span>
<span class='fu'>xpd</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x.</span><span class='op'>[</span><span class='va'>var</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; y ~ xa
#&gt; &lt;environment: 0x00000000426d0dd8&gt;</div><div class='input'>
<span class='co'># ... the variables can be multiple</span>
<span class='va'>vars</span> <span class='op'>=</span> <span class='va'>LETTERS</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span>
<span class='fu'>xpd</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>x.</span><span class='op'>[</span><span class='va'>vars</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; y ~ xA + xB + xC
#&gt; &lt;environment: 0x00000000426d0dd8&gt;</div><div class='input'>
<span class='co'># You can have "complex" variable names but they must be nested in character form</span>
<span class='fu'>xpd</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>~</span> <span class='va'>.</span><span class='op'>[</span><span class='st'>"x.[vars]_sq"</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; y ~ xA_sq + xB_sq + xC_sq
#&gt; &lt;environment: 0x00000000426d0dd8&gt;</div><div class='input'>
<span class='co'># DSB can be used within regular expressions</span>
<span class='va'>re</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GNP"</span>, <span class='st'>"Pop"</span><span class='op'>)</span>
<span class='fu'>xpd</span><span class='op'>(</span><span class='va'>Unemployed</span> <span class='op'>~</span> <span class='fu'>..</span><span class='op'>(</span><span class='st'>".[re]"</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>longley</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Unemployed ~ GNP.deflator + GNP + Population
#&gt; &lt;environment: 0x00000000426d0dd8&gt;</div><div class='input'>
<span class='co'># =&gt; equivalent to ..("GNP|Pop")</span>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Laurent Berge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


